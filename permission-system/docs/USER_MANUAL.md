# 表权限管理系统用户手册

## 目录

- [系统介绍](#系统介绍)
- [开始使用](#开始使用)
- [用户管理](#用户管理)
- [表权限管理](#表权限管理)
- [列权限管理](#列权限管理)
- [行权限管理](#行权限管理)
- [常见问题解答](#常见问题解答)
- [故障排除](#故障排除)
- [联系支持](#联系支持)

## 系统介绍

表权限管理系统是一个全面的权限控制解决方案，专为数据库管理员、数据分析师和IT管理人员设计。本系统能够精细化控制用户对数据库表、列和行的访问权限，实现多维度的数据安全保护。

### 核心功能

- **表级权限控制**：限制用户对特定数据库表的访问
- **列级权限控制**：指定用户可见的数据列，并提供数据脱敏功能
- **行级权限控制**：通过自定义条件过滤用户可访问的数据行
- **角色与用户管理**：灵活的用户角色分配与权限管理
- **权限审计**：全面记录权限变更操作，提供完整审计日志

## 开始使用

### 登录系统

1. 在浏览器中打开系统地址 (例如 `http://your-domain.com` 或由管理员提供的地址)
2. 输入管理员提供的用户名和密码
3. 点击"登录"按钮

![登录界面](../frontend/public/images/login_screen.png)

### 界面导航

登录成功后，您将看到主导航菜单，包括以下主要功能区域：

- **仪表盘**：显示系统概览和关键统计信息
- **用户管理**：创建和管理用户账户
- **表权限**：管理表级别的访问控制
- **列权限**：管理列级别的访问控制与数据脱敏
- **行权限**：管理基于条件的行级过滤
- **审计日志**：查看系统操作记录
- **个人设置**：修改个人账户信息和密码

## 用户管理

> 注意：只有管理员角色才能访问用户管理功能。

### 创建新用户

1. 在主导航菜单中点击"用户管理"
2. 点击页面右上角的"新增用户"按钮
3. 填写新用户信息表单：
   - 用户名（必填）
   - 密码（必填）
   - 电子邮箱（选填）
   - 选择用户角色（必填）
4. 点击"保存"按钮完成创建

### 编辑用户信息

1. 在用户列表中找到目标用户
2. 点击操作列中的"编辑"按钮
3. 修改用户信息
4. 点击"保存"按钮确认更改

### 删除用户

1. 在用户列表中找到目标用户
2. 点击操作列中的"删除"按钮
3. 在确认对话框中点击"确认"

### 重置用户密码

1. 在用户列表中找到目标用户
2. 点击操作列中的"重置密码"按钮
3. 输入新密码并确认
4. 点击"保存"按钮

## 表权限管理

表权限控制用户对特定数据库表的访问权限。

### 创建表权限

1. 在主导航菜单中点击"表权限"
2. 点击"新增权限"按钮
3. 填写表权限表单：
   - 数据库名称（必填）
   - 表名称（必填）
   - 用户名（必填）
   - 角色名称（必填）
   - 描述（选填）
4. 点击"保存"按钮

![表权限创建界面](../frontend/public/images/table_permission_create.png)

### 查询表权限

1. 在"表权限"页面使用过滤条件：
   - 数据库名称
   - 表名称
   - 用户名
   - 角色名称
2. 点击"查询"按钮
3. 系统显示符合条件的表权限列表

### 编辑表权限

1. 在表权限列表中找到目标权限记录
2. 点击操作列中的"编辑"按钮
3. 修改权限信息
4. 点击"保存"按钮确认更改

### 删除表权限

1. 在表权限列表中找到目标权限记录
2. 点击操作列中的"删除"按钮
3. 在确认对话框中点击"确认"

## 列权限管理

列权限控制用户对特定数据表中列的访问权限，并支持数据脱敏功能。

### 创建列权限

1. 在主导航菜单中点击"列权限"
2. 点击"新增权限"按钮
3. 填写列权限表单：
   - 数据库名称（必填）
   - 表名称（必填）
   - 列名称（必填）
   - 脱敏类型（必填，可选：手机号、身份证、银行卡号、座机号、姓名、原文）
   - 用户名（必填）
   - 角色名称（必填）
   - 描述（选填）
4. 点击"保存"按钮

![列权限创建界面](../frontend/public/images/column_permission_create.png)

### 查询列权限

1. 在"列权限"页面使用过滤条件：
   - 数据库名称
   - 表名称
   - 列名称
   - 脱敏类型
   - 用户名
   - 角色名称
2. 点击"查询"按钮
3. 系统显示符合条件的列权限列表

### 编辑列权限

1. 在列权限列表中找到目标权限记录
2. 点击操作列中的"编辑"按钮
3. 修改权限信息
4. 点击"保存"按钮确认更改

### 删除列权限

1. 在列权限列表中找到目标权限记录
2. 点击操作列中的"删除"按钮
3. 在确认对话框中点击"确认"

### 脱敏类型说明

系统支持多种脱敏类型，对不同类型的敏感数据提供不同的保护措施：

- **手机号**：显示前3位和后4位，中间用星号代替，例如 138****1234
- **身份证**：显示前6位和后4位，中间用星号代替，例如 110101********1234
- **银行卡号**：仅显示最后4位，其余用星号代替，例如 ************1234
- **座机号**：显示区号和最后2位，中间用星号代替，例如 010-****12
- **姓名**：仅显示第一个字符，其余用星号代替，例如 张***
- **原文**：不做脱敏处理，显示原始数据

## 行权限管理

行权限通过设置条件表达式来过滤数据表中的行记录，限制用户只能访问特定条件下的数据行。

### 创建行权限

1. 在主导航菜单中点击"行权限"
2. 点击"新增权限"按钮
3. 填写行权限表单：
   - 数据库名称（必填）
   - 表名称（必填）
   - 行过滤条件（必填，SQL条件表达式）
   - 用户名（必填）
   - 角色名称（必填）
   - 描述（选填）
4. 点击"保存"按钮

![行权限创建界面](../frontend/public/images/row_permission_create.png)

### 条件表达式语法

行过滤条件使用SQL WHERE子句语法，例如：

- `department = 'IT'` - 只能查看IT部门的数据
- `create_time > '2023-01-01'` - 只能查看2023年之后创建的数据
- `amount < 10000` - 只能查看金额小于10000的数据
- `region = 'North' AND status = 'active'` - 组合条件，只能查看北区且状态为活跃的数据

### 查询行权限

1. 在"行权限"页面使用过滤条件：
   - 数据库名称
   - 表名称
   - 用户名
   - 角色名称
2. 点击"查询"按钮
3. 系统显示符合条件的行权限列表

### 编辑行权限

1. 在行权限列表中找到目标权限记录
2. 点击操作列中的"编辑"按钮
3. 修改权限信息
4. 点击"保存"按钮确认更改

### 删除行权限

1. 在行权限列表中找到目标权限记录
2. 点击操作列中的"删除"按钮
3. 在确认对话框中点击"确认"

## 常见问题解答

### Q: 如何同时应用多个权限级别?

**A**: 系统会自动组合应用表权限、列权限和行权限。例如，当用户访问数据时：
1. 首先检查表权限，确认用户是否有访问表的权限
2. 然后应用列权限，只展示允许的列并按照脱敏规则处理数据
3. 最后应用行权限，根据过滤条件过滤出可见的行记录

### Q: 权限冲突时如何处理?

**A**: 当存在权限冲突时，系统采用最严格原则：
- 如果没有明确授予权限，则默认拒绝访问
- 如果同一用户有多条针对同一对象的权限规则，取其中最严格的规则

### Q: 如何批量导入权限配置?

**A**: 管理员可以使用批量导入功能：
1. 在各权限页面点击"批量导入"按钮
2. 下载模板文件
3. 填写模板文件
4. 上传填写完成的文件
5. 系统将验证并导入权限配置

### Q: 权限更改后多久生效?

**A**: 权限变更立即生效。用户下一次查询数据时将应用新的权限设置。

## 故障排除

### 登录问题

**症状**: 无法登录系统
**可能原因**:
- 用户名或密码错误
- 账户被锁定
- 账户过期

**解决方法**:
1. 确认用户名和密码输入正确，注意大小写
2. 联系管理员解锁账户或重置密码
3. 检查账户有效期

### 权限不生效

**症状**: 修改权限后未生效
**可能原因**:
- 缓存未更新
- 存在优先级更高的权限规则
- 数据同步延迟

**解决方法**:
1. 退出并重新登录系统
2. 检查是否存在其他优先级更高的权限规则
3. 等待几分钟后重试，或联系系统管理员

### 数据显示异常

**症状**: 数据显示不完整或格式异常
**可能原因**:
- 浏览器兼容性问题
- 脱敏规则配置错误
- 数据源问题

**解决方法**:
1. 尝试使用不同的浏览器（推荐Chrome或Firefox最新版）
2. 检查脱敏规则配置
3. 联系管理员验证数据源连接

## 联系支持

如果您遇到未能在本手册中解决的问题，请通过以下方式联系技术支持团队：

- **电子邮件**: support@example.com
- **内部工单系统**: http://helpdesk.example.com
- **技术支持热线**: 400-123-4567 (工作时间: 周一至周五 9:00-18:00)
